# Payment 400 Error - Debug Guide

## השגיאה שקיבלנו:
```
POST /payment/pay → 400 BAD REQUEST
❌ Payment failed: Payment failed
```

## פרטים שנשלחו:
```javascript
{
  cardNumber: "4580 5613 0942 7921",
  cvv: "857",
  email: "rotemiluz53@gmail.com",
  expiry: "09/31",  // ⚠️ בעיה פוטנציאלית!
  fullName: "rotem iluz"
}
```

---

## בעיה פוטנציאלית #1: תאריך שגוי ⚠️

**`09/31` לא תקף!**

ספטמבר (חודש 9) יש בו רק **30 ימים**, לא 31!

### פתרון:
השתמש בתאריך תקין, לדוגמה:
- `09/30` ✅
- `12/31` ✅ (דצמבר יש 31 ימים)
- `08/28` ✅

---

## בעיה פוטנציאלית #2: חסרים פרטים

Tranzila עלול לדרוש:
- ✅ `card_number` - יש
- ✅ `expire_month` - יש
- ✅ `expire_year` - יש
- ✅ `cvv` - יש
- ✅ `full_name` - יש
- ❓ `card_holder_id` - **חסר!** (ת.ז של בעל הכרטיס)

---

## מה לעשות עכשיו?

### צעד 1: בדוק לוגים בבקאנד

בטרמינל שבו רץ הבקאנד (`python app.py`), חפש לוגים כמו:

```
💳 /payment/pay called
[Payment] Received params: {...}
[Charge] URL: https://api.tranzila.com/...
[Charge] Payload: {...}
[Charge] Response status: 400
[Charge] Response text: {...}
[Charge] Failed with code XXX: [error message]
```

**העתק את כל הלוגים האלה!** הם יגידו לנו בדיוק מה השגיאה מ-Tranzila.

---

### צעד 2: תקן את התאריך

**נסה שוב עם תאריך תקין:**
```
Expiry: 09/30  (במקום 09/31)
```

או עדיף:
```
Expiry: 12/26  (דצמבר 2026 - בטוח תקף)
```

---

### צעד 3: בדוק אם Tranzila דורש ת.ז

אם עדיין לא עובד, יתכן שTranzila דורש `card_holder_id` (ת.ז).

---

## לוגים שאני צריך ממך:

מהטרמינל של **Backend**, העתק את כל הלוגים שמתחילים ב:

```
💳 /payment/pay called
```

עד:

```
[Charge] Failed with code...
```

או:

```
[Charge] Validation error:...
```

זה יגיד לנו **בדיוק** מה השגיאה מ-Tranzila!

---

## אפשרויות נפוצות לשגיאת 400:

1. **תאריך לא תקין** (כמו 09/31) ✅ סביר מאוד
2. **כרטיס לא תקין** (מספר שגוי, לא מאושר)
3. **CVV שגוי**
4. **חסרים פרטים נדרשים** (ת.ז, טלפון, וכו')
5. **Terminal לא מוגדר נכון** ב-Tranzila
6. **הכרטיס לא מאושר לעסקאות אונליין**

---

## מה שאני צריך ממך:

1. ✅ **העתק את הלוגים מהבקאנד**
2. ✅ **נסה שוב עם תאריך תקין** (12/26 לדוגמה)
3. ✅ **ספר לי מה קרה**

אחרי שאני אראה את הלוגים, אוכל להגיד לך בדיוק מה הבעיה ואיך לתקן! 🔍
